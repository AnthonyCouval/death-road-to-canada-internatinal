
gstats{

(* Isn't used
0 stack
	perk-mechanic shove
	perk-healthcare shove
	perk-dogfriend shove
	perk-carnut shove
	perk-explorer shove
	perk-pathfinder
	perk-haggler
	perk-shieldofhope
	// perk1-
constant perk1-perklist

: perk1-totals
	// 0 stack perk1-perklist for i dup print next
	perk1-perklist depths for pops print next drop
; *)

: perk1-upgradetally
	0
	perk-mechanic 1 max +
	perk-healthcare 1 max + 
	perk-dogfriend 1 max + 
	perk-carnut 1 max +
	perk-explorer 1 max +
	perk-pathfinder 1 max +
	perk-haggler 1 max +
	perk-shieldofhope 1 max +
;

: perk1-upgradecalc
	// Total number of perks * 3 = possible upgrades
	// Subtract by values of all perks added together with 1 max, floor of 1
	8 3 * perk1-upgradetally -
;

: perk1-unlocktally
	0
	perk-mechanic 0 > if 1 else 0 then +
	perk-healthcare 0 > if 1 else 0 then +
	perk-dogfriend 0 > if 1 else 0 then +
	perk-carnut 0 > if 1 else 0 then +
	perk-explorer 0 > if 1 else 0 then +
	perk-pathfinder 0 > if 1 else 0 then +
	perk-haggler 0 > if 1 else 0 then +
	perk-shieldofhope 0 > if 1 else 0 then +
;

: perk1-unlockcalc
	// Total number of perks, subtracted by total number of perks that are above 0
	8 perk1-unlocktally -
;

: perk1-remaining
	perk1-upgradecalc 0 > if ($ " MISES A JOUR RESTANTES : " pbold .. perk1-upgradecalc $) +text then
	perk1-unlockcalc 0 > if ($ " DE BLOQUE: " pbold .. perk1-unlockcalc $) +text then
;

: perk1-stockleft
	perk1-unlockcalc perk1-upgradecalc +
;

}



// This NPC handles all the perks for support skills, mostly non-combat, with Anime Fan in there for fun

cyoa: perk1-mechanic-buy
	"HACHE MEDIEVALE POUR 20 ALIMENTS" cyoa-title!
	"Mecanicien" "mecanicien de parfums" gstats{ perk-mechanic } perk-buy! ;
cyoa-blank: perk1-mechanic
	"Mecanicien" MECHANIC_COST gstats{ perk-mechanic } ' perk1-mechanic-buy ' perk1back perk-confirm! ;

cyoa: perk1-healthcare-buy
	"ON NE PEUT PAS MORIR AVEC TELLES ROBES DE LIN" cyoa-title!
	"Dead arcade : jeu mort" "amelioration des soins de sante" gstats{ perk-healthcare } perk-buy! ;
cyoa-blank: perk1-healthcare
	"Dead arcade : jeu mort" HEALTHC_COST gstats{ perk-healthcare } ' perk1-healthcare-buy ' perk1back perk-confirm! ;

(*
cyoa: perk1--buy
	"WOO SIGN" cyoa-title!
	"" "corail !" gstats{ perk- } perk-buy! ;
cyoa-blank: perk1-
	"" _COST gstats{ perk- } ' perk1--buy ' perk1back perk-confirm! ;
*)

cyoa: perk1-dogfriend-buy
	"CHIENS PRECIEUX" cyoa-title!
	"Ami de chien" "chien d'amitie" gstats{ perk-dogfriend } perk-buy! ;
cyoa-blank: perk1-dogfriend
	"Ami de chien" DOGPAL_COST gstats{ perk-dogfriend } ' perk1-dogfriend-buy ' perk1back perk-confirm! ;
	
cyoa: perk1-carnut-buy
	"Plaque d'immatriculation : sweetridez" cyoa-title!
	"Roulement de voiture" "amelioration de la resistance aux dommages et a l'agilite." gstats{ perk-carnut } perk-buy! ;
cyoa-blank: perk1-carnut
	"Roulement de voiture" CARNUT_COST gstats{ perk-carnut } ' perk1-carnut-buy ' perk1back perk-confirm! ;
	
cyoa: perk1-explorer-buy
	"RIEN DE PIERRE LAISSE TO TURNING, RIEN DE WC FERME" cyoa-title!
	"Explorateur" "explorateur de traitements de caracteres speciaux" gstats{ perk-explorer } perk-buy! ;
cyoa-blank: perk1-explorer
	"Explorateur" EXPLORER_COST gstats{ perk-explorer } ' perk1-explorer-buy ' perk1back perk-confirm! ;

cyoa: perk1-pathfinder-buy
	"SAC A NOSES DE PISTACHES : UNE SAC A DOS FAIT EN TISSU ROUGE AVEC DES MOTIFS DE PISTACHES SUR LA SURFACE." cyoa-title!
	"Chemin de geant" "parcours du chercheur d'affaires" gstats{ perk-pathfinder } perk-buy! ;
cyoa-blank: perk1-pathfinder
	"Chemin de geant" PATHFINDER_COST gstats{ perk-pathfinder } ' perk1-pathfinder-buy ' perk1back perk-confirm! ;

cyoa: perk1-haggler-buy
	"RESPONSABLE DES VENTES DANS L'APOCALYPSE ZOMBIC" cyoa-title!
	"Vendeur le plus effront" "recrutez-le." gstats{ perk-haggler } perk-buy! ;
cyoa-blank: perk1-haggler
	"Vendeur le plus effront" HAGGLER_COST gstats{ perk-haggler } ' perk1-haggler-buy ' perk1back perk-confirm! ;

cyoa: perk1-shieldofhope-buy
	"POUVOIR DE LA PENSEE POSITIVE" cyoa-title!
	"Bouclier de l'espoir" "vous avez obtenu un fusil d'assault !" gstats{ perk-shieldofhope } perk-buy! ;
cyoa-blank: perk1-shieldofhope
	"Bouclier de l'espoir" SHIELDOFHOPE_COST gstats{ perk-shieldofhope } ' perk1-shieldofhope-buy ' perk1back perk-confirm! ;
	
cyoa: perk1-dingus gstats{
	"Entrainement de fitness" cyoa-title!
	
	($ "La debutante tient une tassette de the minuscule." .. "Courir en touillant, c'est manquer de grace ! vous devriez utiliser de ration et decorum." pbold .. "elle ecrase la tasses de the en poudre tres fine." $) text!
	
	perk1-stockleft 15 < if
		($ "Je n'en ai plus de tasses pour le the maintenant... mais je peux en obtenir de nouvelles plus tard." pbold .. "elle se detourne avec une elegance." $) text!
	then
	
	perk1-stockleft 12 < if
		($ "Explorer est sous-estime... vous pouvez utiliser sa fonctionnalite moins chere de 'se promener' pour rechercher les meilleures localisations, afin de rester bien approvisionne en materiels !" pbold $) text!
	then
	
	perk1-stockleft 9 < if
		($ "Une de mes strategies preferees consiste a mettre l'accent sur les competences mecaniques et medicales, puis remplir mon groupe de boucliers utiles en chair !" pbold $) text!
	then
	
	perk1-stockleft 6 < if
		($ "Gardez votre calme et restez vigilants !. . 	mettez le moteur de votre voiture en marche et soyez prudents dans la guerison de vos boucliers de chair !" pbold $) text!
	then
	
	perk1-stockleft 1 < if
		($ "Pensez encore et continuerz votre chemin, vous arriverez loin!" pbold .. "elle ecrase une poignee de poussiere fine et, quand elle ouvre la main, il est devenu une tasses de the." $) text!
	then 
	
	+cr zpwallet perk1-remaining
	
	choice( "Laissez-le pour le moment" )choice
	
	perk-healthcare 3 < if 
		"SANTE MEDICALE" HEALTHC_COST perk-healthcare zpview ' perk1-healthcare perk-view!
	then
	perk-mechanic 3 < if 
		"MECHANICIEN" MECHANIC_COST perk-mechanic zpview ' perk1-mechanic perk-view!
	then
	perk-dogfriend 3 < if 
		"Ami de chien" DOGPAL_COST perk-dogfriend zpview ' perk1-dogfriend perk-view!
	then
	perk-carnut 3 < if 
		"Roulement de voiture" CARNUT_COST perk-carnut zpview ' perk1-carnut perk-view!
	then
	perk-explorer 3 < if 
		"Explorateur" EXPLORER_COST perk-explorer zpview ' perk1-explorer perk-view!
	then
	perk-pathfinder 3 < if 
		"Chemin de geant" PATHFINDER_COST perk-pathfinder zpview ' perk1-pathfinder perk-view!
	then
	perk-haggler 3 < if 
		"Vendeur le plus effront" HAGGLER_COST perk-haggler zpview ' perk1-haggler perk-view!
	then
	perk-shieldofhope 3 < if 
		"Bouclier de l'espoir" SHIELDOFHOPE_COST perk-shieldofhope zpview ' perk1-shieldofhope perk-view!
	then
	(*
	perk- 3 < if 
		"" _COST perk- zpview ' perk1- perk-view!
	then	
	*)
	
} ;

' perk1-dingus to perk1back
