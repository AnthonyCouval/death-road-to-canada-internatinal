// Change one $add-rooms to $load-rooms if you want to edit them in the room editor directly, but change it back to $add-rooms when done

"../deathforth/rooms/eyeball.txt" $add-rooms
"events/inner/officeloc.df" $load // Pretty much just for the office counter

// Uncomment below for easy testing with "events/rareloc/dmv.df" $load-region to-mission in hack.df
// Also see final lines for turning regiondef on for testing

// "../deathforth/rooms/restroom.txt" $add-rooms

cyoa{

: dmv-cool-namer args( chara )
	"Cool " <- chara .name@ $cat <- chara .name!
;

: dmv-text-1
	($ cname .. "''s Name ist jetzt " $) text!
;

: dmv-text-2
	($ cname .. "'! Der Fuhrerschein sagt es! Es ist rechtlich bindend!" $) +text clear-cyoa
;

: dmv-text-badname
	cchar dsyp? if
		($ cname .. " ' stort der Name nicht wirklich so sehr. Er passt irgendwie!" $) +crtext goodfx
		morale++ vitality++ statmod{ -5 to dsyp-farted }
	then;
	($ cname .. "  bildet sofort einen riesigen Chip auf " .. chis .. "  schulter. " .. cHe .. "  tritt in einen permanenten Zustand brodelnder Wut ein!" $) +crtext strength++ fitness++ morale-- temper-- badfx
;

cyoa-choice: dmv-machine-1
	dmv-text-1 "Smellbert" pchar .name! dmv-text-2
	"Was fur ein vollig schrecklicher neuer Name!" +crtext dmv-text-badname
;

cyoa-choice: dmv-machine-2
	dmv-text-1 "Fartfart" pchar .name! dmv-text-2
	($ "Das ist immer noch besser als " .. chis .. "  vorheriger Name." $) +crtext dmv-text-badname
;

cyoa-choice: dmv-machine-3
	dmv-text-1 "Harry Ham" pchar .name! dmv-text-2
	$( cname .. "  war der beliebteste Name seit Jahrhunderten im spaten Mittelalter, sowohl fur Madchen als auch fur Jungen. Es wurde angenommen, dass es einen Segen fur gute Gesundheit darstellte." $) +crtext
	vitality++ goodfx
;

cyoa-choice: dmv-machine-4
	dmv-text-1 pchar dmv-cool-namer dmv-text-2
	($ cname .. "  fuhlt sich mit " .. chis .. "  neuer Name!" $) +crtext
	morale3+ goodfx
;

cyoa-bridge: dmv-machine-go
	"'Wie soll der Name auf dem Fuhrerschein lauten?" text!
	choice( "Smellbert" )choice: dmv-machine-1
	choice( "Fartfart" )choice: dmv-machine-2
	choice( "Harry Ham" )choice: dmv-machine-3
	choice( "Cool " .. pchar .name@ )choice: dmv-machine-4
;

cyoa: dmv-machine
	"A License... to Drive" cyoa-title! picon!
	"'Ich kann nicht glauben dass du die Schlange ubersprungen hast! Sehr unhoflich! Dies ist eine Maschine zum Drucken von Fuhrerscheinen. Sie kann einen letzten Fuhrerschein drucken bevor die Vorrate aufgebraucht sind." text!
	($ pname .. "  konnte einen neuen gebrauchen, " .. phis .. "  fuhrerschein lauft bald ab!" $) +crtext
		choice( "Lass es erstmal so" )choice
		choice( "Neuen Fuhrerschein drucken" )choice: dmv-machine-go
;

}

map{ roomgen{ : dmv-machine hospitalmachine swolebolt cyoa{ ' dmv-machine cyoa! } ; } }

locdef{
		
location: dmv
		max-rooms: 4
		entry-tags: dmvstart
		pre-script: set-theme-office
		script: set-theme-office
				
		: dmvdoors
			random-door "dmvend" only-with-door
			random-door "toilette" only-with-door
			random-door "toilette" only-with-door
		;
		
		room-choice: dmvstart
			room-weight: 80
			room-count: 1
			room-script: nad
			room-post-script: dmvdoors 5diff %zombs
			
		room-choice: dmvend
			room-weight: 1
			room-count: 1
			room-script: nad
			room-post-script: 10diff %zombs
			filter-only
			
		room-choice: restroom
			room-weight: 1
			room-count: 2
			room-script: nad
			room-post-script: 20diff %zombs
			filter-only
			
}

// Comment the (* and *) lines out for easy testing, see line 6
// Remove the comments you add before actually putting them in the city generator
(*
regiondef{			

	region: dmv
		script: timeofday o'clock

		inside
					
		loc-choice: dmv 
		loc-weight: 99 
		loc-count: 1

}
*)