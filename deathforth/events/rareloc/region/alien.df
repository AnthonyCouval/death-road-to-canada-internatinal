
0 value alienopen
0 value grayalien

cyoa{ mission{

cyoa: cyoa-alien-car
	alienopen 1 > if cyoa-car then;
//	PRINTSTACK thing# to them# player .id@ to me#
	alienopen 0 > if
	"Vamos la!" cyoa-title!
		($ "A porta abre quando " .. pname .. "  tocala!		Este carro alienigena e impressionante ja!		" $) cyoa-text!
			morale++all
			2 to alienopen goodfx
			choice( "Entre no carro" )choice: get-into-car
			choice( "Deixe por enquanto" )choice
	else
	"Objeto Rapido Indentificado" cyoa-title!
		"'A inspecao mais detalhada mostra que isso nao e um OVNI. E algum tipo de carro estranho! Nao ha porta visivel nele." cyoa-text!
		grayalien .alive? if
			"O pequeno alienigena deve saber abrir isto."
		else
			"'Com o alienigena comido por zumbis, nao ha mais como abrir isso! Nao ha mais nada a fazer a nao ser sair quando puder.'"
		then +crtext
		choice( "Deixe por enquanto" )choice
	then
	STAT_STRENGTH cyoachar .effstat 99 > if
		choice( "Pega o carro" )choice: lift-car
	then

;

} }

cyoa{

cyoa: maninblack
	nearest .character@ to recruitee
	recruitee choosechar cicon
	dead? if npc-died then;
	"Homem de Preto" cyoa-title!
	($ "Ele e um homem sem expressao em um terno preto." .. "Nao ha alienigenas aqui! Nao existe tal coisa como alienigenas! Alem disso, zumbis nao existem!" pbold $) cyoa-text! clear-cyoa
;

cyoa: alien
	1 nearest .character@ .party!
	grayalien choosechar cicon
	dead? if npc-died then;
	"Eu Quero Acreditar" cyoa-title!
	($ "A verdade e que os aliens existem!" .. "  VOCE SABIA!" rbold $) text!
	region.zombie_basespawn@ 1 < if
		1 to alienopen clear-cyoa deleteme goodfx
		($ "O alien cutuca " .. pname .. "  com um dedo brilhante. " .. pHis .. "  cerebro esta cheio de informacoes sobre como abrir portas de carros destrancadas um pouco mais complicadas!		O alienigena aproveita a oportunidade para fugir." $)
	else
		"O alienigena esta um pouco ocupado no momento! Tente conversar mais tarde, se sobreviver a este cerco!" 
	then +crtext
;

}

: .maninblack
	47 over .specialtype!
	4 over .strength!
	3 over .fitness!
	4 over .shooting!
	0 over .female!
	"MIB" over .name!
	WEAPON_PISTOL over .weapona!
	30 LOOT_BULLET 2 pick .lootamt!
	drop
;

: alien map{ selected } . cr new-npc@ .alien lt .character@ to grayalien
	lt cyoa{ ' alien cyoa! } drop ;

: maninblack map{ selected } . cr new-npc@ .maninblack lt cyoa{ ' maninblack cyoa! } drop ;

: spawn-alien-car 
	18 spawncar mission{ cyoa{ ' cyoa-alien-car cyoa! } } 1 lt .no_hit!
;

: alien-trees map{
	20 for
		tree
		-60 60 frnd anglexy 0.5 pixelw * xymul 0.6 0.4 frnd * lt .pos xyadd lt .pos!
	next

	1 light_mode!
	0 1 0 tint_thing_near!
} ;


regiondef{

	 region: forest ufo
		w: 24
		h: 15
		on-foot
		script: timeofday o'clock

		no-prefab // Don't build that default city
		
		: setup-ufo-forest
			map{ grass } spawn-alien-car
			alien maninblack
			mission{ siege-start-dig }
			alien-trees
			// ' garf-survived to post-mission-cyoa
		;

		post-script: setup-ufo-forest 
}
