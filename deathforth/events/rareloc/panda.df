
cyoa{

// Unused
: npc-panda-go 
	($ cname .. "  inizia a seguire " .. pname .. "  per un po!" $) +crtext ccharget
;

: npc-panda-recruit
	cchar to recruitee goodfx clear-cyoa
	($ "Il panda sembra voler seguire " .. pname .. "!" $) +crtext
	pchar .morale3+ pchar .loyaltyREV pchar .attitudeREV
	recruitee .strengthREV recruitee .fitnessREV
	0.25 cchar .ai.wander_chance! 0 nearest .unseen!
	recruit-yesno
;

: npc-panda-attack
	($ "Il panda " .. "si lancia!" rbold $) +crtext pchar .ouch-- bitefx
;

cyoa-bridge: npc-panda-food
	($ pname .. "  offre del cibo al panda." $) text!
	50 %chance if 
		npc-panda-recruit
	else
		($ "Il panda mastica il cibo e poi lo sputa. I panda sono schizzinosi, ma puoi continuare a provare con altro cibo." $) +crtext badfx
	then	
	-1 add-food
;

cyoa-bridge: npc-panda-pull
	($ pname .. "  tira il panda verso " .. phim .. " ' nella speranza che l'animale lo segua. Sembra che valga la pena provare." $) text!
	50 %chance if 
		npc-panda-recruit
	else
		npc-panda-attack
	then	
	
;

cyoa-bridge: npc-panda-charm
	pchar isdogpal? if
		($ pname .. "  usa " .. phis .. "  PSICOLOGIA DEL CANE sul panda, che e un tipo di cane." $) text!
		npc-panda-recruit
	else
		pchar charming? if 
			($ pname .. "  usa " .. phis .. "  fascino naturale per convincere il panda a seguirlo." $) text!
			npc-panda-recruit
		else
			($ "Il panda sembra solo irritato da " .. pname .. "." $) text!
			npc-panda-attack
		then
	then
;

// pchar .nonfatal if then

cyoa: npc-panda
	"Paura del panda" cyoa-title!
	nearest .character@ choosechar cicon
	($ "'E un panda, in piedi intorno all'edificio distrutto. Fissa " .. pname .. " with a blank expression. It may be possible to get it to follow you..." $) text!
	"'ATTENZIONE: probabilmente ti uccidera a meno che tu non gli offra del cibo. E uno stupido con il 50% di possibilita di sprecare il tuo cibo." rbold +crtext
		choice( "Lascialo stare" )choice
		choice( "Tira il panda" )choice: npc-panda-pull
		LOOT_FOOD pchar .lootamt@ 0 > if
			choice( "Attirarlo con il cibo" )choice: npc-panda-food
		then
		choice( "Attirarlo con il fascino" )choice: npc-panda-charm	
;

}

: .panda args( char )
	35 <- char .specialtype!
	"Panda" <- char .name!
	WEAPON_FIERCE <- char .weapon_default!
	2 STAT_STRENGTH <- char .bonus!
	6 <- char .strength!
	6 <- char .fitness!
	1 <- char .female!
	1 <- char .carrying.slot_count!
	"e un panda. Davvero carino a meno che non sia arrabbiato." <- char .job!
	<- char cyoa{ ' npc-panda cyoa! }
	drop
;

locdef{
		
location
		tags: panda
		max-rooms: 2
		entry-tags: trashed
		script: set-theme-house
		pre-script: set-theme-house
		
		room-choice: trashed
			room-weight: 10
			room-count: 2
			room-script: nad
			room-post-script: still-npc .panda
			filter-only
			
}