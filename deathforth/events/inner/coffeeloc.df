cyoa{

: coffeed pchar statmod{ dup .coffee .untired } ;
: coffeed? pchar statmod{ .coffee? } ;

cyoa-choice: coffee-get2
	($ cname .. "  nutzt alle " .. chis .. "  mechanischen Fahigkeiten, um herauszufinden, wozu die vielen, vielen Knopfe auf der Kaffeemaschine dienen.	" .. cHe .. " ' macht die perfekte Tasse Kaffee! Sie ist kostlich!	Die Kaffeemaschine funkt, raucht und geht kaputt." $) cyoa-text!
		coffeed	pchar statmod{ .unsick }
		morale2+ dexterity++ goodfx clear-cyoa mechanicREV
;

cyoa-choice: coffee-get1
	pchar statmod{ .sick? } if
		($ cname .. " ' fuhlt sich zu krank um Kaffee zu genieen der vielleicht schon seit Jahren in einer Maschine steht." $) cyoa-text! badfx 50 %chance if sting-- then
	then;
	coffeed? if
		($ cname .. " ' trinkt NOCH MEHR Kaffee und fuhlt sich danach ziemlich krank.		Es ist schwer zu sagen, ob es an der riesigen Menge Koffein lag, den schmutzigen Tassen oder daran, dass der Kaffee seit einer unbekannten Zeit verrottet." $) cyoa-text! badfx pchar statmod{ dup .sick .uncoffee }
	else
		($ cname .. "  spruht etwas Kaffee in eine alte Tasse die herumliegt und trinkt ihn dann.		" .. cHe .. " ' fuhlt sich ganz KAFFEEIG an." $) cyoa-text!
			goodfx coffeed
	then
;

cyoa: coffee-get
	"Apokalyptischer Kaffee" cyoa-title!
	picon!
	"'Diese riesige und komplexe Kaffeemaschine wurde gebaut, um einige verschiedene Arten von Weltuntergangsszenarien zu uberstehen. Dies war ein groer Teil der Marketingkampagne dieses Coffeeshops. Wahrheit in der Werbung, es funktioniert immer noch!" cyoa-text!
	chumany? not if
		($ pname .. "'hat nicht die erste Ahnung, wie man dieses Ding bedient. Und wirklich " .. cdogcat .. "'s darfver eigentlich kein Kaffee trinken." $) +crtext	
	then;
		pchar charchoice( "  bekommt KAFFEE" )choice: coffee-get1
		cmechanic+ if
			pchar charchoice( "  stort sich mit den Einstellungen" )choice: coffee-get2
		then
	choice( "Lass es alleine" )choice
;

}
		
map{ roomgen{

: coffeemachine
	spawn special_objects48_base_id 0x 6 + lt .spriteid!
	rndflip bbox immovable as-metal
	cyoa{ ' coffee-get cyoa! }
;
} }

locdef{
	
location: coffee
		max-rooms: 2
		entry-tags: coffee
		script: set-theme-restaurant

		room-choice: coffee
			room-weight: 10
			room-count: 1
			room-script: 
			room-post-script: 10diff %zombs map{ room-garbage }
			filter-only		

		room-choice: restroom
			room-weight: 10
			room-count: 1
			room-script: floor-bath
			
}