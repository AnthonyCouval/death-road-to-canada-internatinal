cyoa{ regiondef{

// Witch and Cauldron

: black-cat

	// Black cat
	new-npc lt .character@ .catify
	8 lt .character@ .bodytype!
	lt .character@ .default-ai-setup
;

: .my-cat-thing .user.ival@ #thing ;

: .get-black-cat args( chara )

	black-cat

	// Store the cat's THINGID for the witch
	lt thing# <- chara .user.ival!

	// Store the witch's THINGID for the cat
//	<- chara .thing@ thing# lt <- chara .user.ival!
;

: witch-done
	($ "La bruja se rie y luego le dice a " .. thegroup .. "  que se vaya." $) +crtext clear-cyoa
;

: charm-witch
	most-charming if
		choosechar ($ "  La bruja le da " .. cname .. " una escoba de bruja gratis." .. "TAL VEZ PUEDAS SER UNA BRUJA ALGUN DIA! *RISAS*" pbold $) 
		+cr +text 1 WEAPON_WITCH trunk.weapon+ cicon
	then
;

cyoa-bridge: trade-witch-20
	($ Thegroup .. " soborna a la bruja para que se una al equipo!" .. "PUEDO TRAER MI CALDERO CONMIGO?" pbold $) cyoa-text! basic-tone
	-20 trunk-food+
	clear-cyoa cchar to recruitee
	team-full? if
		($ "El grupo esta lleno. A quien te gustaria reemplazar para hacer espacio para la bruja?" $) +crtext
		' recruit-replace cyoa-team-choice
	else
		recruited
	then

	charm-witch
;

: trade-witch-roll 
	dup .cwits+ if .morale-- else .morale3+ then 
;

: mew-recruit recruitee .thing@ statmod{ .mew } ;

cyoa-bridge: trade-witch-10
	($ Thegroup .. " buys a BLACK CAT...
	" .. "PUES, CREO QUE PUEDES MANEJAR TENER UNA MASCOTA!" pbold $) cyoa-text! basic-tone

	interactee .character@ .my-cat-thing .character@ to recruitee

	ricon

	-13 trunk-food+ ricon
	witch-done
	team-full? if
		($ "A quien te gustaria reemplazar para hacer espacio para el" $) +crtext
		' recruit-replace cyoa-team-choice
	else
		recruited
	then
	charm-witch

	1 ' mew-recruit timer_add
;

cyoa-choice: trade-witch-5
	($ Thegroup .. " compra una escoba de bruja!" .. "ESTA ESCOBA HA SIDO INFUNDIDA CON EL PODER DE LA MAGIA NEGRA, ASI QUE BARRERA EL DOBLE DE BIEN QUE UNA ESCOBA NORMAL!" pbold $) cyoa-text! basic-tone
	1 WEAPON_WITCH trunk.weapon+ -5 trunk-food+
	witch-done
;

cyoa-choice: trade-witch-1
	($ pname .. " 	Le pregunta a la bruja sobre su caldero." .. "Puedes beber de ella si quieres! Es muy venenosa." pbold $) cyoa-text! basic-tone
	witch-done
;

cyoa-choice: trade-witch-coolit
	cpet? if
		($ cname .. " emite un ped" $)
	else
		($ cname .. " dile al comerciante de brujas que me deje en paz " .. "ESPERA UN RATO. 	POR COMO LE GUSTA TANTO EL CAZUELA! NO!" pbold $) then cyoa-text!
	cool-it++
		($ "La bruja se apodera de " .. cname .. ".
		" .. "MAKE FUN OF THE WITCH'S BREW?
			GET THROWN IN THE WITCH'S STEW!!" rbold $) badfx +crtext 
		($ "La bruja lanza a " .. chim .. " en la olla!" $) +crtext
		cpet? if
			($ cname .. " esta completamente sumergido en un guiso venenoso! Yum!" $) +crtext
			cchar .sting2-
			cchar .morale2+
			cchar .vitality++
		else
			($ cname .. " 1 VIDA MAXIMA REDUCIDA A 1" rbold $) +crtext
			cchar .skelbody
			cchar .morale2-
			cchar .dexterity++
		then
			attitudeREV witsREV trade-flee
;

cyoa: trade-rare-witch
	"La Bruja y el Caldero" cyoa-title!
	nearest .character@ choosechar cicon
	($ "	Estas molestando a esta bruja de hacer actividades de bruja." .. "ME PUEDES MOLESTAR UNA VEZ Y SOLO UNA VEZ, ESTOY OCUPADA CON MIS ACTIVIDADES DE BRUJA!" pbold $) cyoa-text! basic-tone foodamt
	choice( "Calles por el momento" )choice
	most-grating if 
		charchoice( " te pido que TE QUIEDAS" fcoolit )choice: trade-witch-coolit
	then
	trunk-food 5 < if
		choice( "Que hay de la Olla" )choice: trade-witch-1
	else
		trunk-food 19 > if
			choice( "Recruta a la Bruja para 20 comida" )choice: trade-witch-20
		then
		trunk-food 12 > if
			choice( "Gato Negro por 13 comida" )choice: trade-witch-10
		then
		trunk-food 4 > if
			choice( "'Broom de la Bruja por 5 comida" )choice: trade-witch-5
		then
	then
;

0 value kip-lab-zap

: kip-lab-foodcheck kip-lab-zap 1 < if 5 else 20 then ;

cyoa-choice: trade-rare-lab-go
	"Actualizacion Genetica" cyoa-title!
	($ cname .. " entra en la maquina y recibe un golpe de " .. "RAYOS COSMICOS" fbold .. ". " .. cHe .. "  se siente con energia!" $) text!
	strength++ fitness++ cchar .fullheal
	lab-effect depths 0= if LAB-EFFECT shuffles to lab-effect then
	drawcard 
	kip-lab-foodcheck -1 * trunk-food+
	' kip-lab-zap ++

	// FX
	sfx{ growl 5000 ramp_start! 10000 ramp_end! 2 scale! 1000 d! 0.95 s! 1000 r! }
	-3 fade_to 0 1 0 fade_clr 60 fade_count!
	10 0.95 rumble-gui
;

cyoa-bridge: trade-rare-lab-pick
	solo if
		someone choosechar trade-rare-lab-go
	then;
		"COSMIC RAAAAAAAAYS" cyoa-title!
		($ "A quien deberian golpear " .. "RAYOS COSMICOS?" fbold $) text!
		' trade-rare-lab-go cyoa-team-choice
;

cyoa: trade-rare-lab
	"'Maquina de ciencia de Kip" cyoa-title!
	nearest .character@ choosechar cicon
	($ "'Es una especie de lagarto alienigena. A nadie parece importarle.	" .. "Por una pequena tarifa puedo arruinar permanentemente tu codigo genetico " pbold $) cyoa-text! basic-tone
	kip-lab-zap 1 < if
		($ "75% de descuento en el primer zap! Eso es un trato!" pbold $)
	else
		($ "GRANDE!" fbold $)
	then +text
	+cr foodamt
	choice( "Rechazar oferta generosa" )choice
	trunk-food kip-lab-foodcheck < if
		"'Lamentablemente, no puedes permitirte esta dulce oferta." +crtext
	else
		choice( "Suena bien!   " .. kip-lab-foodcheck .. "  comida" )choice: trade-rare-lab-pick
	then
;

// Head Swap Doctor

0 var 3-dochead-stack

: headicon 7 * special_chars_base_id + 5 + cyoa-choice-iconid! ;

: cyoa-3-docheads
	3-dochead-stack sizes for 3-dochead-stack drawcard
	next drop
;

defer trade-rare-doc-repick

: dochead-cancel
	text!
	"Quien deberia obtener esta cabeza?" +crtext
	choice( "Elige una cabeza diferente" )choice: trade-rare-doc-repick
;
: dochead-done text! goodfx clear-cyoa -5 trunk-food+ ;

// The Heads

cyoa-choice: doc-chicken-go
	($ cname .. " ' obtiene una nueva cabeza de pollo! Esta impregnado de todos los poderes y habilidades de un pollo." $) dochead-done
		($ cname .. "  ahora tiene un CEREBRO PEQUENO!" rbold $) +crtext
		86 cchar .specialhead!
		0 cchar .wits! witsREV
		-1 STAT_VITALITY cchar .stat+ sting--
		dexterity++
;
cyoa-bridge: doc-chicken-go4
	"'Quien deberia obtener la cabeza del pollo?" text!
	' doc-chicken-go cyoa-human-choice

;
cyoa-bridge: doc-chicken "'Un pollo no es conocido por su dureza o inteligencia, pero por otro lado, puede aletear bastante rapido." dochead-cancel
	numhums 3 > if
		' doc-chicken-go 2 #cyoa-human-choice
		choice( "Escoge a alguien mas" )choice: doc-chicken-go4
	else
		' doc-chicken-go cyoa-human-choice
	then
;

cyoa-choice: doc-hero-go
	($ cname .. "  obtiene la cabeza de un heroe!" $) dochead-done
		($ cname .. "  obtiene una actitud mas heroica!" rbold $) +crtext
		18 cchar .specialhead! -4 cchar .headoff.y!
		6 cchar .loyalty! loyaltyREV 6 cchar .attitude! attitudeREV
;
cyoa-bridge: doc-hero-go4
	"'Quien deberia obtener la cabeza del heroe?" text!
	' doc-hero-go cyoa-human-choice

;
cyoa-bridge: doc-hero "Incluso flotando en un frasco, esta cabeza de mandibula cuadrada parece uno de esos tipos heroicos leales y positivos." dochead-cancel
	numhums 3 > if
		' doc-hero-go 2 #cyoa-human-choice
		choice( "Escoge a alguien mas" )choice: doc-hero-go4
	else
		' doc-hero-go cyoa-human-choice
	then
;

cyoa-choice: doc-dog-go
	($ cname .. " ' obtiene una cabeza de perro!" $) dochead-done
		($ cname .. "  ahora tiene un CEREBRO PEQUENO PERO LEAL!" rbold $) +crtext
		22 cchar .specialhead! -4 cchar .headoff.y!
		0 cchar .wits! witsREV 6 cchar .loyalty! loyaltyREV
;
cyoa-bridge: doc-dog-go4
	"'Quien deberia obtener la cabeza del perro?" text!
	' doc-dog-go cyoa-human-choice

;
cyoa-bridge: doc-dog "'Los perros son el mejor amigo del hombre! Es probable que la cabeza de un perro sea una gran mejora con respecto a tu traicionera cabeza no canina. Como beneficio adicional, la cabeza esta fumando una pequena pipa." dochead-cancel
	numhums 3 > if
		' doc-dog-go 2 #cyoa-human-choice
		choice( "Escoge a alguien mas" )choice: doc-dog-go4
	else
		' doc-dog-go cyoa-human-choice
	then
;

cyoa-choice: doc-clown-go
	($ cname .. " ' ahora tiene cabeza de payaso. Nada bueno podria salir de esto." $) dochead-done
		29 cchar .specialhead! -2 cchar .headoff.y!
		0 cchar .loyalty!
		// Change specialtype to clown without changing body?
		cchar morale--all-except
;
cyoa-bridge: doc-clown-go4
	"'Quien deberia obtener la cabeza del payaso?" text!
	' doc-clown-go cyoa-human-choice

;
cyoa-bridge: doc-clown "'El doctor te muestra la cabeza de un payaso flotando en un frasco. Es aterrador. Esto PARECE una mala idea." dochead-cancel
	numhums 3 > if
		' doc-clown-go 2 #cyoa-human-choice
		choice( "Escoge a alguien mas" )choice: doc-clown-go4
	else
		' doc-clown-go cyoa-human-choice
	then
;

cyoa-choice: doc-gnome-go
	($ cname .. "  ahora se siente un poco gnomo." $) dochead-done
		25 %chance if
			33
		else
			75 
		then cchar .specialhead! -1 cchar .headoff.x!
		WEAPON_POKIN cchar .weapon_default!		
;
cyoa-bridge: doc-gnome-go4
	"'Quien deberia obtener la cabeza del gnomo?" text!
	' doc-gnome-go cyoa-human-choice

;
cyoa-bridge: doc-gnome "El doctor te ofrece reemplazar tu cabeza con un gnomo. Si, la criatura del bosque de fantasia." dochead-cancel
	numhums 3 > if
		' doc-gnome-go 2 #cyoa-human-choice
		choice( "Escoge a alguien mas" )choice: doc-gnome-go4
	else
		' doc-gnome-go cyoa-human-choice
	then
;

cyoa-choice: doc-robot-go
	($ cname .. "  es una especie de cyborg. Con suerte " .. che .. "  ahora puede hablar con el automovil la proxima vez que se descomponga." $) dochead-done
		($ cname .. "'EL MAXIMO MECANICO DE 'S AUMENTADO!" rbold $) +crtext
		50 %chance if
			39
		else
			40 
		then cchar .specialhead! -1 cchar .headoff.y!
		1 STAT_MECHANICAL cchar .bonus+ mechanicREV
;
cyoa-bridge: doc-robot-go4
	"'Quien deberia obtener la cabeza del robot?" text!
	' doc-robot-go cyoa-human-choice

;
cyoa-bridge: doc-robot "El doctor muestra una elegante cabeza de robot. Conviertete en uno con las maquinas!" dochead-cancel
	numhums 3 > if
		' doc-robot-go 2 #cyoa-human-choice
		choice( "Escoge a alguien mas" )choice: doc-robot-go4
	else
		' doc-robot-go cyoa-human-choice
	then
;

cyoa-choice: doc-alien-go
	($ cname .. " ' ahora esta infundido con INTELIGENCIA EXTRANJERA! Aunque, en retrospectiva, es probable que el extraterrestre no fuera el mas inteligente de su especie." $) dochead-done
		51 cchar .specialhead! -1 cchar .headoff.y!
		6 cchar .wits! witsREV
;
cyoa-bridge: doc-alien-go4
	"Quien deberia obtener la cabeza del alienigena?" text!
	' doc-alien-go cyoa-human-choice

;
cyoa-bridge: doc-alien "El doctor presenta una cabeza de extraterrestre en una jarra. THE TRUTH IS OUT THERE. La cabeza de alien parece ser una forma de vida mas evolucionada y inteligente, aunque no tan evolucionada que pudiera escapar de quedarse en una pequena jarra." dochead-cancel
	numhums 3 > if
		' doc-alien-go 2 #cyoa-human-choice
		choice( "Escoge a alguien mas" )choice: doc-alien-go4
	else
		' doc-alien-go cyoa-human-choice
	then
;

cyoa-choice: doc-beaver-go
	($ cname .. "  ahora es mitad castor! Esta gloriosa representacion de Canada mejora el animo." $) dochead-done
		77 cchar .specialhead! 5 cchar .headoff.y! 3 cchar .headoff.x!
		fitness++ fitnessREV
		morale2+all
;
cyoa-bridge: doc-beaver-go4
	"'Quien debe recibir la cabeza del castor?" text!
	' doc-beaver-go cyoa-human-choice

;
cyoa-bridge: doc-beaver "'Los castores se conocen por su capacidad para ejercicio aerobico. Estan siempre bailando y haciendo saltos. Creo que eso es lo que escuche en documentales de naturaleza." dochead-cancel
	numhums 3 > if
		' doc-beaver-go 2 #cyoa-human-choice
		choice( "Escoge a alguien mas" )choice: doc-beaver-go4
	else
		' doc-beaver-go cyoa-human-choice
	then
;

cyoa-choice: doc-skele-go
	($ cname .. "  ahora tiene una calavera en lugar de una cabeza. Esto es " .. "Muy cool." fbold $) dochead-done
		($ cname .. "'su FUERZA MAXIMA, LA FIESTERA Y SU TIRADA EN DISPARO SE AUMENTARON!" rbold $) +crtext
		78 cchar .specialhead! -1 cchar .headoff.y!
		-1 STAT_VITALITY cchar .stat+ sting--
		1 STAT_STRENGTH cchar .bonus+ 
		1 STAT_FITNESS cchar .bonus+
		1 STAT_SHOOTING cchar .bonus+		
;
cyoa-bridge: doc-skele-go4
	"'Quien debe recibir la calavera del bodybuilder?" text!
	' doc-skele-go cyoa-human-choice

;
cyoa-bridge: doc-skele "'El doctor dice que va a traer su MEJOR cabeza de trasplante, y resulta ser una calavera. Intrigante." dochead-cancel
	numhums 3 > if
		' doc-skele-go 2 #cyoa-human-choice
		choice( "Escoge a alguien mas" )choice: doc-skele-go4
	else
		' doc-skele-go cyoa-human-choice
	then
;

cyoa-choice: doc-swole-go
	($ cname .. "  ahora tiene el potencial de convertirse en demasiado musculoso para controlarlo!" $) dochead-done
		($ cname .. "'su FUERZA MAXIMA SE AUMENTO!" rbold $) +crtext
		25 cchar .specialhead! -4 cchar .headoff.y!
		1 STAT_STRENGTH cchar .bonus+ strengthREV	
;
cyoa-bridge: doc-swole-go4
	"'Quien debe recibir la cabeza del bodybuilder?" text!
	' doc-swole-go cyoa-human-choice

;
cyoa-bridge: doc-swole "Un gran porcentaje de la fuerza de un fisicoculturista viene de la condicion mental! Asi que tener la cabeza de un fisicoculturista deberia permitirte alcanzar nuevas alturas de fuerza!" dochead-cancel
	numhums 3 > if
		' doc-swole-go 2 #cyoa-human-choice
		choice( "Escoge a alguien mas" )choice: doc-swole-go4
	else
		' doc-swole-go cyoa-human-choice
	then
;

cyoa-choice: doc-mallcop-go
	($ cname .. " ahora tiene toda la resistencia y precision de un policia de centro comercial!" $) dochead-done
		($ cname .. "'s MAXIMUM SHOOTING DECREASED!" rbold $) +crtext
		50 %chance if 69 else 70 then
		cchar .specialhead! 0 cchar .headoff.y!
		-2 STAT_SHOOTING cchar .bonus+ shootingREV
		vitality++ cchar .fullheal
;
cyoa-bridge: doc-mallcop-go4
	"Quien deberia obtener la cabeza del guardia del centro comercial?" text!
	' doc-mallcop-go cyoa-human-choice
;
cyoa-bridge: doc-mallcop "Cuando llegue el zomborpocalipsis, los policias de centro comercial heredaran las ruinas de la tierra.    Libro Antiguo de la Profecia de los Policias de Centro Comercial" rbold dochead-cancel
	numhums 3 > if
		' doc-mallcop-go 2 #cyoa-human-choice
		choice( "Escoge a alguien mas" )choice: doc-mallcop-go4
	else
		' doc-mallcop-go cyoa-human-choice
	then
;

cyoa-choice: doc-doc-go
	($ cname .. "  tipo de se siente como un verdadero doctor. Hay algunas dudas porque " .. che .. " ' no obtuve el atuendo de doctor como parte del trasplante." $) dochead-done
		($ cname .. "' MAXIMO MEDICO AUMENTADO!" rbold $) +crtext
		24 cchar .specialhead! -1 cchar .headoff.y!
		0 cchar .loyalty!
		1 STAT_MEDICAL cchar .bonus+ medicalREV
		78 victim .specialhead! -1 victim .headoff.y!
;
cyoa-bridge: doc-doc-go4
	"'Quien deberia recibir la cabeza del doctor loco?" text!
	' doc-doc-go cyoa-human-choice
;
cyoa-bridge: doc-doc "'El doctor senala su cabeza. Afirma que es la segunda mejor que tiene en stock." dochead-cancel
	numhums 3 > if
		' doc-doc-go 2 #cyoa-human-choice
		choice( "Escoge a alguien mas" )choice: doc-doc-go4
	else
		' doc-doc-go cyoa-human-choice
	then
;

// End Heads

deck-new
	"Pollo" choice-card: doc-chicken
	"'Cabeza de heroe" choice-card: doc-hero
	"'Cabeza de perro" choice-card: doc-dog
	"Payaso" choice-card: doc-clown
	"Zona de gnomos" choice-card: doc-gnome
	"Cabeza de robot" choice-card: doc-robot
	"Extraterrestre" choice-card: doc-alien
	"Pequena cabeza de castor" choice-card: doc-beaver
	"Una calavera" choice-card: doc-skele
	"Culturista" choice-card: doc-swole
	"Policia del centro comercial" choice-card: doc-mallcop
	"Doctor loco" choice-card: doc-doc
shuffles value dochead-pick-stack-base // Shuffle before-hand, and just pick the top 3

: draw-3-dochead 3 stack sizes for
		dochead-pick-stack-base i picks nip shove
	next
	to 3-dochead-stack
;

: pick-3-docheads
	choice( "Mantener la cabeza vieja" )choice
	draw-3-dochead
	cyoa-3-docheads
;

cyoa-bridge: trade-rare-doc-pick
	($ "'Genial! Esto es lo que tengo listo para empezar.	Avisame que cabeza te interesa! Solo tengo tiempo para un trasplante. Voy a " pbold .. "GOLF" rbold .. " ' despues de esto porque soy un " pbold .. "DOCTOR." rbold $) text!
		"Una cabeza nueva" cyoa-title!
		
		pick-3-docheads
;

' trade-rare-doc-pick to trade-rare-doc-repick

cyoa: trade-rare-doc
	"Doctor de renombre" cyoa-title!
	nearest .character@ choosechar cicon
	cchar to victim
	($ "'Es un doctor. Un " .. "REAL" rbold .. " ' medico, lleva un uniforme de medico y todo! 	" .. "Let's cut right to the chase... I can replace your head with a better head. " pbold $) cyoa-text! basic-tone
		numhums 1 < if
			($ "Wait a second... get out of here! I'm not a vet!" rbold $) +text
		else
			($ "'NO estoy loco! Pero me estoy volviendo loco, asi que hay un gran descuento. Solo 5 comidas!" rbold $) +text +cr foodamt
		then
	
	trunk-food 5 < numhums 1 < or if
		"'Parece que te quedaste con tu vieja cabeza." +crtext
		choice( "Dejar en gran verguenza" )choice
	else
		choice( "No way, Jose" )choice
		choice( "Muestrame lo que tienes!" )choice: trade-rare-doc-pick
	then
;

// Barkley 2 Wizard

0 value wiz-dailyfortune

: diewiz pbold .. " morir una muerte terrible!" fbold ;

0 stack
	"Encontraras a un payaso misterioso, y luego te" shove
	"Veo que encontraras una gran cantidad de comida en el futuro cercano, despues de lo cual cometeras un error y" shove
	"Die" shove
	"No llegaras a Canada, en su lugar iras a" shove
	"The one in need" shove
	"Llegaras a Canada! Lo veo! Entonces tu" shove
	"'Usted sera sucedido por un ejercito de perros superinteligentes que crearan una nueva civilizacion. Reemplazaran a la humanidad. Usted no vera esto porque usted" shove
	"Los zombis se aburren y se rinden. Esto sucede mucho despues de que usted" shove
	"Decir TRANQUILO mete a su equipo en problemas, y usted" rbold shove
	"Sus numeros de la suerte son 4 y 22! Tambien, usted" shove
	"Un extrano misterioso se cruzara en su camino y ambos" shove
	"Todos los zombis son reemplazados por hombres lobo y usted" shove
	"'El Pozo de los Deseos se esconde en la Cripta de la Descomposicion! Usted no lo encontrara, usted" shove
	"'Llovera manana. O no. Una de esas dos. Usted" shove
	"'Mayormente solo veo muerte en su futuro, lo siento. Lo mas probable es que usted" shove
	"Las profecias hablan de usted! Ellas dicen que usted" shove
	"'Usted lograra llegar a Canada! Esta previsto! Es broma, usted" shove
value wizard-fortune-base
wizard-fortune-base shuffles var wizard-fortune

cyoa-choice: trade-rare-wiz-fortune
	"SU FORTUNA" cyoa-title!
	($ wizard-fortune pops nip diewiz $) text!
	-1 trunk-food+
	' wiz-dailyfortune ++
	morale--all
	someone choosechar
	($ cname .. " se resuelve a desafiar al destino!" $) +crtext
		($ cname .. "    sALUD Y SUERTE MAXIMAS AUMENTADAS!" rbold $) +crtext
		vitality++
		777777777 cchar .seed!
;

cyoa-choice: trade-rare-wiz-tarot-go
	($ "La lectura del tarot revela asombrosas verdades personales sobre " .. cname .. "." $) text!
	-5 trunk-food+
	cchar .showitall
;

cyoa-bridge: trade-rare-wiz-tarot
	solo if
		someone choosechar trade-rare-wiz-tarot-go
	then;
	"Quien deberia recibir la lectura de tarot? Revelara mucho sobre ellos." text!
	' trade-rare-wiz-tarot-go cyoa-team-choice
;

cyoa-bridge: trade-rare-wiz-recruit
	($ Thegroup .. " contrata al mago!	" .. "Las profecias aun dicen que tu" diewiz $) cyoa-text! basic-tone
	-20 trunk-food+
	clear-cyoa cchar to recruitee witsREV
	team-full? if
		($ "El grupo esta lleno.		A quien te gustaria reemplazar para hacerle un lugar al mago?" $) +crtext
		' recruit-replace cyoa-team-choice
	else
		recruited
	then	

;

cyoa: trade-rare-wiz
	"El Mago" cyoa-title!
	nearest .character@ choosechar cicon
	($ "Este tipo parece que podria ser un mago.	" .. "'Soy un mago! Puedo predecir tu futuro o revelar verdades ocultas con el poder del tarot!" pbold $) cyoa-text! basic-tone
	+text +cr foodamt
	trunk-food 1 < if
		($ "'Fortuna gratis: Te vas a morir de hambre! Entonces" diewiz $) +crtext
		choice( "Genial, una fortuna gratis!" )choice
	else
		choice( "No le des nada a este FRAUDE" )choice
		wiz-dailyfortune 1 < if
			choice( "Obtener fortuna   1 comida" )choice: trade-rare-wiz-fortune
		then
	then
	trunk-food 4 > if
		choice( "Obtener una lectura del tarot   5 comidas" )choice: trade-rare-wiz-tarot
	then
	trunk-food 19 > if
		choice( "Reclutar mago   20 comidas" )choice: trade-rare-wiz-recruit
	then
;

// Book seller

0 value rarebook-cheap
0 value rarebook-dog
0 value rarebook-map

: trade-rare-book-cheap
	' rarebook-cheap ++
	cyoa{ bookmag-get2 }
	-5 trunk-food+
;

cyoa-choice: trade-rare-book-dog
	' rarebook-dog ++
	($ Thegroup .. " lee " .. "LA GUIA DEFINITIVA DE LOS PERROS" pbold .. ". Este libro enorme tiene todas las paginas llenas de conocimientos sobre perros." $) cyoa-text! goodfx
	($ gHe .. "  obtiene la ventaja: " .. "AMIGO DE LOS PERROS!" fbold $) +crtext
	statmod{ ' .dogpal foreach-human-char }
	-15 trunk-food+
;

cyoa-choice: trade-rare-book-map
	' rarebook-map ++
	($ Thegroup .. "  compra " .. "'ATLAS DE MAPAS DE P.L. PLARKEN" pbold .. ". Contiene mapas de todas las calles desde aqui hasta Canada. Esto sera extremadamente valioso." $) cyoa-text! goodfx
	($ gHe .. "  obtiene la ventaja: " .. "EXPLORADOR!" fbold $) +crtext
	statmod{ ' .explorer foreach-human-char }
	-15 trunk-food+
;

: trade-rare-book-draw
	choice( bookmagtitle .. "    5 de comida" )choice: trade-rare-book-cheap
;

cyoa: trade-rare-book
	"Libros raros" cyoa-title!
	nearest .character@ choosechar cicon
	($ "'Esta comerciante de libros habla sobre como vende valiosos libros raros.	" .. "'Por favor, no te metas con los libros de exhibicion! Son falsos, los puse para confundir a los ladrones de libros." pbold $) cyoa-text! basic-tone
	+text +cr foodamt
	trunk-food 5 < if
		($ "'No tienes suficiente comida para comprar ninguno de los buenos libros!" $) +crtext
		choice( "Yo queria esos libros" )choice
	else
		choice( "Los libros son para nerds" )choice
		trunk-food 4 > rarebook-cheap 1 < and if
			trade-rare-book-draw
		then
		trunk-food 14 > if
			rarebook-dog 1 < if
				choice( "LA GUIA DEFINITIVA DE LOS PERROS" pbold .. "    15 alimentos" )choice: trade-rare-book-dog
			then
			rarebook-map 1 < if
				choice( "'ATLAS DE MAPAS DE P.L. PLARKEN" pbold .. "    15 alimentos" )choice: trade-rare-book-map
			then
		then
	then
;

// COLD STEEL

cyoa-choice: trade-rare-coldsteel-buy
	($ Thegroup .. "  compra la espada gigante.	" .. "No te arrepentiras de comprar una espada Cold Steel!" pbold $) cyoa-text! basic-tone
	1 WEAPON_ZWEI trunk.weapon+ -45 trunk-food+
	clear-cyoa goodfx
;

cyoa-bridge: trade-rare-coldsteel-demo
	clear-cyoa cchar to recruitee goodfx 
	($ "'Penso que nunca lo preguntarias.	" .. Thegroup .. "  recluta temporalmente " .. rname .. "  para que pueda proporcionar una demostracion en vivo.	" .. "'Te sorprendera el poder de la Espada Grande Cold Steel!" pbold $) cyoa-text! basic-tone
	team-full? if
		($ "El grupo esta lleno.		A quien te gustaria reemplazar para dejar espacio?" $) +crtext
		recruit-replace?
	else
		recruited
	then	

;

cyoa-bridge: trade-rare-coldsteel-demo-fullgroup
	($ "Tu grupo esta lleno. Si pides la demostracion, " .. "tendras que elegir un miembro del equipo para expulsarlo del grupo! A continuacion obtendras un recluta temporal para la siguiente ubicacion." rbold $) cyoa-text!
	choice( "Cancelar la demostracion" )choice
	choice( "Abandonar a alguien para la demostracion" )choice: trade-rare-coldsteel-demo
;

cyoa: trade-rare-coldsteel
	"Cuchillos Cold Steel" cyoa-title!
	nearest .character@ choosechar cicon
	($ "'Estoy vendiendo el arma mas fina que jamas hayas visto, antes o despues del apocalipsis zombi. Es la Espada Grande Cold Steel de Cold Steel Knives! Solo 45 alimentos!" pbold $) cyoa-text! basic-tone
	+text +cr foodamt
	choice( "'No soy lo suficientemente bueno para esta espada " .. DX )choice
	trunk-food 44 > if
		choice( "Greatsword" )choice: trade-rare-coldsteel-buy
	then
	team-full? if
		choice( "Solicitar una demostracion" )choice: trade-rare-coldsteel-demo-fullgroup
	else
		choice( "Solicitar una demostracion" )choice: trade-rare-coldsteel-demo
	then

;

// SKELETAL KNIGHT

0 value skelknight-bomb
0 value skelknight-hammer
0 value skelknight-gladius

cyoa-bridge: trade-skelknight-25
	($ Thegroup .. "  compra la " .. "MARTILLO DE CRANEO." fbold .. "Contempla el increible poder destructivo de mi martillo de craneo corto." pbold $) cyoa-text! basic-tone
	1 WEAPON_SKULLMACE trunk.weapon+ -25 trunk-food+ ' skelknight-hammer ++ goodfx
;

cyoa-bridge: trade-skelknight-15
	($ Thegroup .. " compra la espada corta del esqueleto!	" .. "Esta gladius es una gran espada, sin embargo, no me gustaba porque no esta tematizada con craneos." pbold $) cyoa-text! basic-tone
	1 WEAPON_GLADIUS trunk.weapon+ -15 trunk-food+ ' skelknight-gladius ++
;

cyoa-choice: trade-skelknight-5
	($ Thegroup .. " compra cinco Bombas de Craneo!	" .. "Estas bombas estan encantadas con el poder destructivo de CRANEO!" pbold $) cyoa-text! basic-tone
	5 WEAPON_BOMBSKULL trunk.weapon+ -5 trunk-food+ ' skelknight-bomb ++
;

cyoa-choice: trade-skelknight-1
	($ pname .. " le pregunta al esqueleto por que necesita comida." .. "Porque me la como, idiota!" pbold $) cyoa-text!
	pchar .morale-- badfx
;

cyoa-choice: trade-skelknight-coolit
	cpet? if
		($ cname .. " 'se tira un pedo en la pila de huesos del caballero esqueleto." $)
	else
		($ cname .. " le dice al caballero esqueletico que " .. "SE CALME." pbold $)
	then cyoa-text!
	cool-it-7 if
		($ "Su craneo hace rapidos crujidos. Risa?" .. "'No he oido una broma como esa en diez siglos!" pbold $) goodfx +crtext
			WEAPON_GLADIUS recruitee .weaponb!
			1 recruitee .weapon_nodropb!
			WEAPON_BOMBSKULL recruitee .weaponc!
			3 recruitee .stackedc!
		cooled-it 
		team-full? if
			($ "Insiste en unirse. A quien te gustaria reemplazar para dejar espacio para " .. rname .. "?" $) +crtext
			' recruit-replace cyoa-team-choice
		else
			recruited
		then clear-cyoa recruitee .strengthREV recruitee .fitnessREV
	else cool-it++
		($ "CALMATE! CALMATE!!" pbold .. "el caballero fuertemente armado amenaza con enviar " .. thegroup .. " a la " .. "ZONA OSEA" fbold $) +crtext badfx trade-flee
	then attitudeREV witsREV

;

cyoa: trade-rare-skelknight
	"Caballero Esqueleto" cyoa-title!
	nearest .character@ choosechar cchar to recruitee ricon
	($ "'Es un esqueleto animado, que lleva una armadura de placas." .. "'Tambien odio a los zombis. Estan cubiertos de piel y carne. Es repugnante!" pbold $) cyoa-text!
	skelknight-bomb 1 < skelknight-hammer 1 < skelknight-gladius 1 < or or if 
		"'Les vendere algunas de mis armas de repuesto, si les place."
	else
		"'Eso es todo lo que puedo prescindir! Diviertete con tu cruzada."
	then pbold +crtext
	basic-tone foodamt
	choice( "No gracias" )choice
	most-grating if 
		charchoice( "  le dice que SE CALME" fcoolit )choice: trade-skelknight-coolit
	then
	trunk-food 5 < if
		choice( "Preguntar por que necesita comida" )choice: trade-skelknight-1
	else
		trunk-food 24 > skelknight-hammer 1 < and if
			choice( "Martillo Calavera por 25 de comida" )choice: trade-skelknight-25
		then
		trunk-food 14 > skelknight-gladius 1 < and if
			choice( "Gladius por 15 de comida" )choice: trade-skelknight-15
		then
		trunk-food 4 > skelknight-bomb 1 < and if
			choice( "5 Bombas Calavera por 5 de comida" )choice: trade-skelknight-5
		then
	then
;

// Sleepy Trader

0 value sleepy-ate

: sleepy-ate-food sleepy-ate 1 < if	1 else sleepy-ate 2 < if 2 else 4 then then ;

cyoa-choice: trade-rare-sleep-feed
	($ pname .. " ' mete comida en la cara de la persona dormida." $) text!
	sleepy-ate-food -1 * trunk-food+
	' sleepy-ate ++
	sleepy-ate 2 > if
		($ pname .. "  comienza a entender " .. vhis .. "  perfecta tranquilidad zen, y aprende el " .. "SONIDO DORMILON" rbold .. "  habilidad!" $) +crtext 
		statmod{ pchar .soundsleep }
		($ "Alguien se da cuenta de que " .. pname .. " ' ha estado metiendo grandes cantidades de comida en la boca de una persona dormida." $) +crtext
		"HEY! SAL DE ESTE CAMPAMENTO AHORA MISMO!" rbold +crtext
		($ Thegroup .. "  huye, alejandose del campamento de comerciantes!" $) +crtext
		badfx quitmission		
	else
		($ vHe .. "  habla tonterias en " .. vhis .. "  dormir. O al menos parece una tonteria, al principio. " .. pname .. " ' lo piensa y se da cuenta de que es un conocimiento valioso." $) +crtext goodfx
		pchar rewardevent-random
	then
;

cyoa: trade-rare-sleep
	"Comerciante durmiendo" cyoa-title! iicon
	interactee .character@ to victim
	"Esta persona esta dormida. Como pueden dormir tan profundamente en medio del zombocalypse? Justo en el suelo, nada menos." text!
	($ vHe .. "  debe tenerlo todo resuelto." $) +crtext
	sleepy-ate 1 > if
		($ RED .. "ADVERTENCIA: Atasco 4 mas comida en " .. vhis .. "  boca te metera en problemas, pero tambien te dara " .. pname .. "  una nueva habilidad!" rbold $) +crtext
	else
		
	then
		choice( "Salir " .. vhim .. "  solo" )choice
		trunk-food sleepy-ate-food 1 - > if
			pchar charchoice( ": Alimentar " .. vhim .. " " .. sleepy-ate-food  .. "  comida" )choice: trade-rare-sleep-feed
		then
;

// Chicken

0 value chicken-egg

cyoa-choice: trade-chicken-6
	($ pname .. "  compra media docena de huevos. Cuidado zombis!	" .. "BAKKAAAAAAAAAAAAW!" fbold $) cyoa-text!
	goodfx 6 weapondef{ WEAPON_EGG } trunk.weapon+ -6 trunk-food+ 6 ' chicken-egg +!
;

cyoa-choice: trade-chicken-3
	($ pname .. "  compra algunos huevos, agregandolos al arsenal de huevos.	" .. "BAKAAAAW!" rbold $) cyoa-text!
	goodfx 3 weapondef{ WEAPON_EGG } trunk.weapon+ -3 trunk-food+ 3 ' chicken-egg +!
;

cyoa-choice: trade-chicken-1
	($ pname .. "  compra un solo huevo precioso." .. "KAKARAKEO!" pbold $) cyoa-text!
	goodfx 1 weapondef{ WEAPON_EGG } trunk.weapon+ -1 trunk-food+ 1 ' chicken-egg +!
;

cyoa: trade-rare-chicken
	"Pollo de Corral" cyoa-title!
	nearest .character@ choosechar cchar to recruitee ricon
	($ "Este pollo ha abierto un negocio para el!" .. "KAKARAKEO!" pbold $) cyoa-text!
	chicken-egg 11 > if
		"El pollo se ha quedado sin huevos!" +crtext clear-cyoa
	then;
	basic-tone +cr foodamt
	trunk-food 1 < if
		"El pollo se apiada de ti y te regala un huevo gratis." +crtext
		goodfx 1 weapondef{ WEAPON_EGG }  trunk.weapon+ clear-cyoa
	else
		"Esta vendiendo huevos muy frescos! 1 huevo por 1 comida." +crtext
		choice( "No gracias" )choice
		trunk-food 5 > chicken-egg 7 < and if
			choice( "Comprar 6 Huevos" )choice: trade-chicken-6
		then
		trunk-food 2 > chicken-egg 10 < and if
			choice( "Comprar 3 Huevos" )choice: trade-chicken-3
		then
		chicken-egg 12 < if
			choice( "Comprar 1 Huevo" )choice: trade-chicken-1
		then
	then
;

// Nerd

0 value nerd-green
0 value nerd-red

cyoa-choice: trade-nerd-red
	($ pname .. "  compra una torreta roja. La torreta definitiva. Lanzala y luego ve como los zombis son abatidos." .. "No more zombie problems!
	Until the turret runs out of ammo..." pbold $) cyoa-text!
	goodfx 1 WEAPON_TURRETRED trunk.weapon+ -12 trunk-food+ ' nerd-red ++
;

cyoa-choice: trade-nerd-green
	($ pname .. "  compra una torreta verde. Tirala al suelo y mirala ir." .. "Estas pueden ayudar mucho en una pelea!" pbold $) cyoa-text!
	goodfx 1 WEAPON_TURRETGREEN trunk.weapon+ -6 trunk-food+ ' nerd-green ++
;

cyoa: trade-rare-nerd
	"Que Nerd" cyoa-title!
	nearest .character@ choosechar cchar to recruitee ricon
	($ "	En espanol Este nerd esta rodeado de nerd doodads que pitan." .. "No soy un nerd! Tengo muchos intereses! Voy a bares deportivos!" pbold $) cyoa-text!
	nerd-green 1 > nerd-red 0 > and if
		"El nerd se ha quedado sin stock!" +crtext clear-cyoa
	then;
	basic-tone +cr foodamt
	trunk-food 6 < if
		"No puedes comprar nada. El nerd te da una bola de vomito como premio de consolacion." +crtext
		goodfx 1 WEAPON_PUKEYBALL trunk.weapon+ clear-cyoa
	else
		choice( "No gracias" )choice
		trunk-food 5 > nerd-green 2 < and if
			choice( "Comprar torreta verde   6 alimentos" )choice: trade-nerd-green
		then
		trunk-food 11 > nerd-red 1 < and if
			choice( "Comprar torreta roja   12 alimentos" )choice: trade-nerd-red
		then
	then
;

} } 
